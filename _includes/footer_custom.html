{% assign community_search_exclude = page.community_search_exclude or page.search_exclude %}
<center>
  <p>
  {% if community_search_exclude %}
    Want to learn more?
  {% elsif page.layout == 'coming_soon'  %}
    Want to learn about {{ page.title }}?
  {% else %}
    Want to learn more about {{ page.title }}?
  {% endif %}
  </p>

  {% if community_search_exclude %}
    <p>
      <a href="https://www.reddit.com/r/machinetranslation/" class="no-arrow" target="_blank">
        <button id="airtable-button">
          Explore the community
        </button>
      </a>
    </p>
    <p>
      <a href="https://www.reddit.com/r/machinetranslation/submit?selftext=truesubmit&title=Question%20about%20...%20%3F" class="no-arrow" target="_blank">
        <button id="airtable-button">
          Ask your own question
        </button>
      </a>
    </p>
  {% else %}
    {% assign proper_types = "Person|Organization|Product|Event|Language" | split:"|" %}
    {% if page.community_search_term %}
      {% assign community_search_term = page.community_search_term %}
    {% elsif page.autogenerated or proper_types contains page.seo.type or page.parent == "Metrics" %}
      {% assign community_search_term = page.title %}
    {% else %}
      {% assign community_search_term = page.title | downcase %}
    {% endif %}
    <p>
      <a href="https://www.reddit.com/r/machinetranslation/search?q={{ page.title | downcase | url_encode }}&restrict_sr=on" class="no-arrow" target="_blank">
        <button id="airtable-button">
          Search the community for {{ community_search_term }}
        </button>
      </a>
    </p>
    <p>
      <a href="https://www.reddit.com/r/machinetranslation/submit?selftext=true&title=Question: %20{{ page.title | url_encode }}%20...%20%3F&text={{ page.title | url_encode }}%20...%20%3F" class="no-arrow" target="_blank">
        <button id="airtable-button">
          Ask a question about {{ community_search_term }}
        </button>
      </a>
    </p>
  {% endif %}
</center>

<hr/>

<small>

<center>
  {% if page.title == '404' %}
    <p>
      <a
        target="_blank"
        href="https://github.com/machinetranslate/machinetranslate.org/new/master/{{ page.path }}">
        <strong>Create this article →</strong>
      </a>
    </p>
  {% elsif page.layout == 'coming_soon' %}
    <p>
      <a
        target="_blank"
        href="https://github.com/machinetranslate/machinetranslate.org/blob/master/{{ page.path }}">
        <strong>Write this article →</strong>
      </a>
    </p>
  {% else %}
    <p id="edited" style="display: none;">
      Edited on <span id="edited-date"></span> by <a id="edited-username"></a>.
    <p>
    </p>
      <a
        target="_blank"
        href="https://github.com/machinetranslate/machinetranslate.org/blob/master/{{ page.path }}">
        <strong>Edit this article →</strong>
      </a>
    </p>
  {% endif %}
</center>

<center>
    <p>
      Machine Translate is created and edited by contributors like you!
    </p>
    <p>
      <a href="/contributing">Learn more about contributing →</a>
    </p>
  {% if page.layout != "coming_soon" %}
    <p>
      Licensed under <a target="_blank" href="http://creativecommons.org/licenses/by-sa/4.0/">CC-BY-SA-4.0</a>.
    </p>
    <p>
      <a
        target="_blank"
        href="https://machinetranslate.org/about/#attribution">
        Cite this article →
      </a>
    </p>
  {% endif %}
</center>

</small>

<hr/>
<center>
  <div class="social-links">
    {% include github.html %}
    {% include twitter.html %}
    {% include linkedin.html %}
    {% include facebook.html %}
  </div>
</center>

<script>

  function toLocaleString(date) {
    var d = new Date(date);
    return d.toLocaleString('en-UK', { day: 'numeric', month: 'long', year: 'numeric' });
  }

  var url = 'https://api.github.com/repos/{{ site.github.owner_name }}/{{ site.github.repository_name }}/commits?path={{ page.path }}';

  fetch(url)
  .then((response) => response.json())
  .then((commits) => {
    var date = commits[0].commit.committer.date.slice(0,10);
    var username = commits[0].author.login;
    document.getElementById('edited-date').textContent = toLocaleString(date);
    document.getElementById('edited-username').textContent = username;
    document.getElementById('edited-username').href = "https://github.com/" + username;
    document.getElementById('edited').style.display = 'inline'
  });
</script>

<!-- Add separators in sidebar -->
<style>
  .nav-list > hr {
    margin: 0.5rem 2rem;
  }
</style>
<script>
  var ul = document.getElementById('site-nav').children[0];
  var sectionStartLis = [];
  for (var li of ul.children) {
    const title = li.children[0].innerText || li.children[1].innerText;
    console.log(title);
    if ([
      'APIs',
      'Building and research',
      'About Machine Translate'
      ].includes(title)) {
      sectionStartLis.push(li);
    }
  }
  for (li of sectionStartLis) {
    var hr = document.createElement('hr');
    ul.insertBefore(hr, li);
  }
</script>
